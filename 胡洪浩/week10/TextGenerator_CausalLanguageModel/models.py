#!/user/bin/env python3
# -*- coding: utf-8 -*-
"""
@Project ：TextGenerator_CausalLanguageModel 
@File    ：models.py
@IDE     ：PyCharm 
@Author  ：Guyuelegend
@Date    ：2025/3/4 17:28 
"""
import time
import torch
from torch import nn
from transformers import BertModel
from torch.optim import SGD, Adam


class CausalLanguageModel(nn.Module):
    def __init__(self, config):
        super(CausalLanguageModel, self).__init__()
        self.model_type = config["model_type"]
        vocab_size = config["vocab_size"]
        hidden_size = config["hidden_size"]
        num_layers = config["num_layers"]
        self.embedding = nn.Embedding(vocab_size, hidden_size, padding_idx=0)
        if config["model_type"] == "bert":
            self.encoder = BertModel.from_pretrained(config["bert_model_path"], return_dict=False,
                                                     attn_implementation='eager')
            hidden_size = self.encoder.config.hidden_size
            vocab_size = self.encoder.config.vocab_size
        else:
            self.encoder = nn.LSTM(hidden_size, hidden_size, num_layers=num_layers, batch_first=True)
        self.classify = nn.Linear(hidden_size, vocab_size)
        self.loss_func = nn.CrossEntropyLoss(ignore_index=-100)

    def forward(self, x, target=None):
        if target is not None:
            # 定义一个mask的上三角为零，mask为零的元素对应在attention位置会替换成-inf负无穷
            mask = torch.tril(torch.ones(x.shape[0], x.shape[1], x.shape[1]))
            # print(mask, mask.shape, sep='\n')
            if torch.cuda.is_available():
                mask = mask.cuda()
            if self.model_type == "bert":
                x, _ = self.encoder(x, attention_mask=mask)
                # x, _ = self.encoder(x)
            else:
                x = self.embedding(x)
                x, _ = self.encoder(x)
            y = self.classify(x)
            # 300 * vocab_size   // 300*1
            # print(y.view(-1, y.shape[-1]).shape, target.view(-1).shape)
            return self.loss_func(y.view(-1, y.shape[-1]), target.view(-1))

        else:
            if self.model_type == "bert":
                x, _ = self.encoder(x)
            else:
                x = self.embedding(x)
                x, _ = self.encoder(x)
            x = self.classify(x)
            y = torch.nn.functional.softmax(x, dim=-1)
            return y


def choose_optim(config, demo):
    optim_type = config["optim_type"]
    learning_rate = config["learning_rate"]
    if optim_type.upper() == "SGD":
        return SGD(demo.parameters(), lr=learning_rate)
    else:
        return Adam(demo.parameters(), lr=learning_rate)


if __name__ == '__main__':
    from dataloader import generate_data
    from setting import Config

    Config["vocab_size"] = 100
    # start = time.time()
    # dg = generate_data(Config, Config["train_data_path"], False)
    # print("数据加载完成，耗时：{}s".format(time.time() - start))
    # print(next(dg.__iter__()))
    # batch_data = next(dg.__iter__())
    batch_data = [torch.LongTensor([[1898, 3209, 131, 3315, 741, 4507, 3173, 1936, 741, 5381],
                                    [3209, 131, 3315, 741, 4507, 3173, 1936, 741, 5381, 113],
                                    [131, 3315, 741, 4507, 3173, 1936, 741, 5381, 113, 165],
                                    [3315, 741, 4507, 3173, 1936, 741, 5381, 113, 13279, 0],
                                    [741, 4507, 3173, 1936, 741, 5381, 113, 8173, 0, 0],
                                    [4507, 3173, 1936, 741, 5381, 113, 8173, 119, 0, 0],
                                    [3173, 1936, 741, 5381, 113, 8173, 119, 166, 0, 0],
                                    [1936, 741, 5381, 113, 8173, 119, 166, 8118, 0, 0],
                                    [741, 5381, 113, 8173, 119, 166, 8118, 8326, 0, 0],
                                    [5381, 113, 8173, 119, 166, 8118, 11451, 0, 0, 0],
                                    [113, 8173, 119, 166, 8118, 11451, 8118, 0, 0, 0],
                                    [8173, 119, 166, 8118, 11451, 8613, 0, 0, 0, 0],
                                    [13279, 119, 166, 8118, 11451, 8613, 8207, 0, 0, 0],
                                    [165, 119, 166, 8118, 11451, 8613, 8207, 119, 0, 0],
                                    [119, 166, 8118, 11451, 8613, 8207, 119, 145, 0, 0],
                                    [166, 8118, 11451, 8613, 8207, 119, 8792, 0, 0, 0],
                                    [161, 11451, 8613, 8207, 119, 8134, 0, 0, 0, 0],
                                    [11566, 8613, 8207, 119, 8134, 114, 0, 0, 0, 0],
                                    [8310, 9670, 119, 8134, 114, 5632, 0, 0, 0, 0],
                                    [11167, 8207, 119, 8134, 114, 5632, 5381, 0, 0, 0],
                                    [12199, 119, 8134, 114, 5632, 5381, 5317, 0, 0, 0],
                                    [163, 119, 8134, 114, 5632, 5381, 5317, 3119, 0, 0],
                                    [119, 8134, 114, 5632, 5381, 5317, 3119, 7415, 0, 0],
                                    [8134, 114, 5632, 5381, 5317, 3119, 7415, 3146, 0, 0],
                                    [157, 8175, 114, 5632, 5381, 5317, 3119, 7415, 3146, 4415],
                                    [155, 114, 5632, 5381, 5317, 3119, 7415, 3146, 4415, 1169],
                                    [114, 5632, 5381, 5317, 3119, 7415, 3146, 4415, 1169, 868],
                                    [5632, 5381, 5317, 3119, 7415, 3146, 4415, 1169, 868, 117],
                                    [5381, 5317, 3119, 7415, 3146, 4415, 1169, 868, 117, 788],
                                    [5317, 3119, 7415, 3146, 4415, 1169, 868, 117, 788, 897],
                                    [3119, 7415, 3146, 4415, 1169, 868, 117, 788, 897, 769],
                                    [7415, 3146, 4415, 1169, 868, 117, 788, 897, 769, 3837],
                                    [3146, 4415, 1169, 868, 117, 788, 897, 769, 3837, 2110],
                                    [4415, 1169, 868, 117, 788, 897, 769, 3837, 2110, 739],
                                    [1169, 868, 117, 788, 897, 769, 3837, 2110, 739, 886],
                                    [868, 117, 788, 897, 769, 3837, 2110, 739, 886, 4500],
                                    [117, 788, 897, 769, 3837, 2110, 739, 886, 4500, 117],
                                    [788, 897, 769, 3837, 2110, 739, 886, 4500, 117, 4276],
                                    [897, 769, 3837, 2110, 739, 886, 4500, 117, 4276, 3326],
                                    [769, 3837, 2110, 739, 886, 4500, 117, 4276, 3326, 2495],
                                    [3837, 2110, 739, 886, 4500, 117, 4276, 3326, 2495, 1333],
                                    [2110, 739, 886, 4500, 117, 4276, 3326, 2495, 1333, 868],
                                    [739, 886, 4500, 117, 4276, 3326, 2495, 1333, 868, 5442],
                                    [886, 4500, 117, 4276, 3326, 2495, 1333, 868, 5442, 1469],
                                    [4500, 117, 4276, 3326, 2495, 1333, 868, 5442, 1469, 1139],
                                    [117, 4276, 3326, 2495, 1333, 868, 5442, 1469, 1139, 4276],
                                    [4276, 3326, 2495, 1333, 868, 5442, 1469, 1139, 4276, 4852],
                                    [3326, 2495, 1333, 868, 5442, 1469, 1139, 4276, 4852, 2792],
                                    [2495, 1333, 868, 5442, 1469, 1139, 4276, 4852, 2792, 3300],
                                    [1333, 868, 5442, 1469, 1139, 4276, 4852, 2792, 3300, 117],
                                    [868, 5442, 1469, 1139, 4276, 4852, 2792, 3300, 117, 1963],
                                    [5442, 1469, 1139, 4276, 4852, 2792, 3300, 117, 1963, 3362],
                                    [1469, 1139, 4276, 4852, 2792, 3300, 117, 1963, 3362, 1599],
                                    [1139, 4276, 4852, 2792, 3300, 117, 1963, 3362, 1599, 3614],
                                    [4276, 4852, 2792, 3300, 117, 1963, 3362, 1599, 3614, 117],
                                    [4852, 2792, 3300, 117, 1963, 3362, 1599, 3614, 117, 6435],
                                    [2792, 3300, 117, 1963, 3362, 1599, 3614, 117, 6435, 3118],
                                    [3300, 117, 1963, 3362, 1599, 3614, 117, 6435, 3118, 2898],
                                    [117, 1963, 3362, 1599, 3614, 117, 6435, 3118, 2898, 3633],
                                    [1963, 3362, 1599, 3614, 117, 6435, 3118, 2898, 3633, 4276],
                                    [3362, 1599, 3614, 117, 6435, 3118, 2898, 3633, 4276, 119],
                                    [1599, 3614, 117, 6435, 3118, 2898, 3633, 4276, 119, 0],
                                    [3614, 117, 6435, 3118, 2898, 3633, 4276, 119, 0, 0],
                                    [117, 6435, 3118, 2898, 3633, 4276, 119, 0, 0, 0]]),
                  torch.LongTensor([[3209, 131, 3315, 741, 4507, 3173, 1936, 741, 5381, 113],
                                    [131, 3315, 741, 4507, 3173, 1936, 741, 5381, 113, 165],
                                    [3315, 741, 4507, 3173, 1936, 741, 5381, 113, 13279, 0],
                                    [741, 4507, 3173, 1936, 741, 5381, 113, 8173, 0, 0],
                                    [4507, 3173, 1936, 741, 5381, 113, 8173, 119, 0, 0],
                                    [3173, 1936, 741, 5381, 113, 8173, 119, 166, 0, 0],
                                    [1936, 741, 5381, 113, 8173, 119, 166, 8118, 0, 0],
                                    [741, 5381, 113, 8173, 119, 166, 8118, 8326, 0, 0],
                                    [5381, 113, 8173, 119, 166, 8118, 11451, 0, 0, 0],
                                    [113, 8173, 119, 166, 8118, 11451, 8118, 0, 0, 0],
                                    [8173, 119, 166, 8118, 11451, 8613, 0, 0, 0, 0],
                                    [13279, 119, 166, 8118, 11451, 8613, 8207, 0, 0, 0],
                                    [165, 119, 166, 8118, 11451, 8613, 8207, 119, 0, 0],
                                    [119, 166, 8118, 11451, 8613, 8207, 119, 145, 0, 0],
                                    [166, 8118, 11451, 8613, 8207, 119, 8792, 0, 0, 0],
                                    [161, 11451, 8613, 8207, 119, 8134, 0, 0, 0, 0],
                                    [11566, 8613, 8207, 119, 8134, 114, 0, 0, 0, 0],
                                    [8310, 9670, 119, 8134, 114, 5632, 0, 0, 0, 0],
                                    [11167, 8207, 119, 8134, 114, 5632, 5381, 0, 0, 0],
                                    [12199, 119, 8134, 114, 5632, 5381, 5317, 0, 0, 0],
                                    [163, 119, 8134, 114, 5632, 5381, 5317, 3119, 0, 0],
                                    [119, 8134, 114, 5632, 5381, 5317, 3119, 7415, 0, 0],
                                    [8134, 114, 5632, 5381, 5317, 3119, 7415, 3146, 0, 0],
                                    [157, 8175, 114, 5632, 5381, 5317, 3119, 7415, 3146, 4415],
                                    [155, 114, 5632, 5381, 5317, 3119, 7415, 3146, 4415, 1169],
                                    [114, 5632, 5381, 5317, 3119, 7415, 3146, 4415, 1169, 868],
                                    [5632, 5381, 5317, 3119, 7415, 3146, 4415, 1169, 868, 117],
                                    [5381, 5317, 3119, 7415, 3146, 4415, 1169, 868, 117, 788],
                                    [5317, 3119, 7415, 3146, 4415, 1169, 868, 117, 788, 897],
                                    [3119, 7415, 3146, 4415, 1169, 868, 117, 788, 897, 769],
                                    [7415, 3146, 4415, 1169, 868, 117, 788, 897, 769, 3837],
                                    [3146, 4415, 1169, 868, 117, 788, 897, 769, 3837, 2110],
                                    [4415, 1169, 868, 117, 788, 897, 769, 3837, 2110, 739],
                                    [1169, 868, 117, 788, 897, 769, 3837, 2110, 739, 886],
                                    [868, 117, 788, 897, 769, 3837, 2110, 739, 886, 4500],
                                    [117, 788, 897, 769, 3837, 2110, 739, 886, 4500, 117],
                                    [788, 897, 769, 3837, 2110, 739, 886, 4500, 117, 4276],
                                    [897, 769, 3837, 2110, 739, 886, 4500, 117, 4276, 3326],
                                    [769, 3837, 2110, 739, 886, 4500, 117, 4276, 3326, 2495],
                                    [3837, 2110, 739, 886, 4500, 117, 4276, 3326, 2495, 1333],
                                    [2110, 739, 886, 4500, 117, 4276, 3326, 2495, 1333, 868],
                                    [739, 886, 4500, 117, 4276, 3326, 2495, 1333, 868, 5442],
                                    [886, 4500, 117, 4276, 3326, 2495, 1333, 868, 5442, 1469],
                                    [4500, 117, 4276, 3326, 2495, 1333, 868, 5442, 1469, 1139],
                                    [117, 4276, 3326, 2495, 1333, 868, 5442, 1469, 1139, 4276],
                                    [4276, 3326, 2495, 1333, 868, 5442, 1469, 1139, 4276, 4852],
                                    [3326, 2495, 1333, 868, 5442, 1469, 1139, 4276, 4852, 2792],
                                    [2495, 1333, 868, 5442, 1469, 1139, 4276, 4852, 2792, 3300],
                                    [1333, 868, 5442, 1469, 1139, 4276, 4852, 2792, 3300, 117],
                                    [868, 5442, 1469, 1139, 4276, 4852, 2792, 3300, 117, 1963],
                                    [5442, 1469, 1139, 4276, 4852, 2792, 3300, 117, 1963, 3362],
                                    [1469, 1139, 4276, 4852, 2792, 3300, 117, 1963, 3362, 1599],
                                    [1139, 4276, 4852, 2792, 3300, 117, 1963, 3362, 1599, 3614],
                                    [4276, 4852, 2792, 3300, 117, 1963, 3362, 1599, 3614, 117],
                                    [4852, 2792, 3300, 117, 1963, 3362, 1599, 3614, 117, 6435],
                                    [2792, 3300, 117, 1963, 3362, 1599, 3614, 117, 6435, 3118],
                                    [3300, 117, 1963, 3362, 1599, 3614, 117, 6435, 3118, 2898],
                                    [117, 1963, 3362, 1599, 3614, 117, 6435, 3118, 2898, 3633],
                                    [1963, 3362, 1599, 3614, 117, 6435, 3118, 2898, 3633, 4276],
                                    [3362, 1599, 3614, 117, 6435, 3118, 2898, 3633, 4276, 119],
                                    [1599, 3614, 117, 6435, 3118, 2898, 3633, 4276, 119, 0],
                                    [3614, 117, 6435, 3118, 2898, 3633, 4276, 119, 0, 0],
                                    [117, 6435, 3118, 2898, 3633, 4276, 119, 0, 0, 0],
                                    [6435, 3118, 2898, 3633, 4276, 119, 517, 0, 0, 0]])]
    model = CausalLanguageModel(Config)
    if torch.cuda.is_available():
        model = model.cuda()
        batch_data = [d.cuda() for d in batch_data]
    batch_x, batch_y = batch_data
    loss = model(batch_x, batch_y)
    print("第一次loss: ", loss.item())

"""
[tensor([[ 1898,  3209,   131,  3315,   741,  4507,  3173,  1936,   741,  5381],
        [ 3209,   131,  3315,   741,  4507,  3173,  1936,   741,  5381,   113],
        [  131,  3315,   741,  4507,  3173,  1936,   741,  5381,   113,   165],
        [ 3315,   741,  4507,  3173,  1936,   741,  5381,   113, 13279,     0],
        [  741,  4507,  3173,  1936,   741,  5381,   113,  8173,     0,     0],
        [ 4507,  3173,  1936,   741,  5381,   113,  8173,   119,     0,     0],
        [ 3173,  1936,   741,  5381,   113,  8173,   119,   166,     0,     0],
        [ 1936,   741,  5381,   113,  8173,   119,   166,  8118,     0,     0],
        [  741,  5381,   113,  8173,   119,   166,  8118,  8326,     0,     0],
        [ 5381,   113,  8173,   119,   166,  8118, 11451,     0,     0,     0],
        [  113,  8173,   119,   166,  8118, 11451,  8118,     0,     0,     0],
        [ 8173,   119,   166,  8118, 11451,  8613,     0,     0,     0,     0],
        [13279,   119,   166,  8118, 11451,  8613,  8207,     0,     0,     0],
        [  165,   119,   166,  8118, 11451,  8613,  8207,   119,     0,     0],
        [  119,   166,  8118, 11451,  8613,  8207,   119,   145,     0,     0],
        [  166,  8118, 11451,  8613,  8207,   119,  8792,     0,     0,     0],
        [  161, 11451,  8613,  8207,   119,  8134,     0,     0,     0,     0],
        [11566,  8613,  8207,   119,  8134,   114,     0,     0,     0,     0],
        [ 8310,  9670,   119,  8134,   114,  5632,     0,     0,     0,     0],
        [11167,  8207,   119,  8134,   114,  5632,  5381,     0,     0,     0],
        [12199,   119,  8134,   114,  5632,  5381,  5317,     0,     0,     0],
        [  163,   119,  8134,   114,  5632,  5381,  5317,  3119,     0,     0],
        [  119,  8134,   114,  5632,  5381,  5317,  3119,  7415,     0,     0],
        [ 8134,   114,  5632,  5381,  5317,  3119,  7415,  3146,     0,     0],
        [  157,  8175,   114,  5632,  5381,  5317,  3119,  7415,  3146,  4415],
        [  155,   114,  5632,  5381,  5317,  3119,  7415,  3146,  4415,  1169],
        [  114,  5632,  5381,  5317,  3119,  7415,  3146,  4415,  1169,   868],
        [ 5632,  5381,  5317,  3119,  7415,  3146,  4415,  1169,   868,   117],
        [ 5381,  5317,  3119,  7415,  3146,  4415,  1169,   868,   117,   788],
        [ 5317,  3119,  7415,  3146,  4415,  1169,   868,   117,   788,   897],
        [ 3119,  7415,  3146,  4415,  1169,   868,   117,   788,   897,   769],
        [ 7415,  3146,  4415,  1169,   868,   117,   788,   897,   769,  3837],
        [ 3146,  4415,  1169,   868,   117,   788,   897,   769,  3837,  2110],
        [ 4415,  1169,   868,   117,   788,   897,   769,  3837,  2110,   739],
        [ 1169,   868,   117,   788,   897,   769,  3837,  2110,   739,   886],
        [  868,   117,   788,   897,   769,  3837,  2110,   739,   886,  4500],
        [  117,   788,   897,   769,  3837,  2110,   739,   886,  4500,   117],
        [  788,   897,   769,  3837,  2110,   739,   886,  4500,   117,  4276],
        [  897,   769,  3837,  2110,   739,   886,  4500,   117,  4276,  3326],
        [  769,  3837,  2110,   739,   886,  4500,   117,  4276,  3326,  2495],
        [ 3837,  2110,   739,   886,  4500,   117,  4276,  3326,  2495,  1333],
        [ 2110,   739,   886,  4500,   117,  4276,  3326,  2495,  1333,   868],
        [  739,   886,  4500,   117,  4276,  3326,  2495,  1333,   868,  5442],
        [  886,  4500,   117,  4276,  3326,  2495,  1333,   868,  5442,  1469],
        [ 4500,   117,  4276,  3326,  2495,  1333,   868,  5442,  1469,  1139],
        [  117,  4276,  3326,  2495,  1333,   868,  5442,  1469,  1139,  4276],
        [ 4276,  3326,  2495,  1333,   868,  5442,  1469,  1139,  4276,  4852],
        [ 3326,  2495,  1333,   868,  5442,  1469,  1139,  4276,  4852,  2792],
        [ 2495,  1333,   868,  5442,  1469,  1139,  4276,  4852,  2792,  3300],
        [ 1333,   868,  5442,  1469,  1139,  4276,  4852,  2792,  3300,   117],
        [  868,  5442,  1469,  1139,  4276,  4852,  2792,  3300,   117,  1963],
        [ 5442,  1469,  1139,  4276,  4852,  2792,  3300,   117,  1963,  3362],
        [ 1469,  1139,  4276,  4852,  2792,  3300,   117,  1963,  3362,  1599],
        [ 1139,  4276,  4852,  2792,  3300,   117,  1963,  3362,  1599,  3614],
        [ 4276,  4852,  2792,  3300,   117,  1963,  3362,  1599,  3614,   117],
        [ 4852,  2792,  3300,   117,  1963,  3362,  1599,  3614,   117,  6435],
        [ 2792,  3300,   117,  1963,  3362,  1599,  3614,   117,  6435,  3118],
        [ 3300,   117,  1963,  3362,  1599,  3614,   117,  6435,  3118,  2898],
        [  117,  1963,  3362,  1599,  3614,   117,  6435,  3118,  2898,  3633],
        [ 1963,  3362,  1599,  3614,   117,  6435,  3118,  2898,  3633,  4276],
        [ 3362,  1599,  3614,   117,  6435,  3118,  2898,  3633,  4276,   119],
        [ 1599,  3614,   117,  6435,  3118,  2898,  3633,  4276,   119,     0],
        [ 3614,   117,  6435,  3118,  2898,  3633,  4276,   119,     0,     0],
        [  117,  6435,  3118,  2898,  3633,  4276,   119,     0,     0,     0]]), tensor([[ 3209,   131,  3315,   741,  4507,  3173,  1936,   741,  5381,   113],
        [  131,  3315,   741,  4507,  3173,  1936,   741,  5381,   113,   165],
        [ 3315,   741,  4507,  3173,  1936,   741,  5381,   113, 13279,     0],
        [  741,  4507,  3173,  1936,   741,  5381,   113,  8173,     0,     0],
        [ 4507,  3173,  1936,   741,  5381,   113,  8173,   119,     0,     0],
        [ 3173,  1936,   741,  5381,   113,  8173,   119,   166,     0,     0],
        [ 1936,   741,  5381,   113,  8173,   119,   166,  8118,     0,     0],
        [  741,  5381,   113,  8173,   119,   166,  8118,  8326,     0,     0],
        [ 5381,   113,  8173,   119,   166,  8118, 11451,     0,     0,     0],
        [  113,  8173,   119,   166,  8118, 11451,  8118,     0,     0,     0],
        [ 8173,   119,   166,  8118, 11451,  8613,     0,     0,     0,     0],
        [13279,   119,   166,  8118, 11451,  8613,  8207,     0,     0,     0],
        [  165,   119,   166,  8118, 11451,  8613,  8207,   119,     0,     0],
        [  119,   166,  8118, 11451,  8613,  8207,   119,   145,     0,     0],
        [  166,  8118, 11451,  8613,  8207,   119,  8792,     0,     0,     0],
        [  161, 11451,  8613,  8207,   119,  8134,     0,     0,     0,     0],
        [11566,  8613,  8207,   119,  8134,   114,     0,     0,     0,     0],
        [ 8310,  9670,   119,  8134,   114,  5632,     0,     0,     0,     0],
        [11167,  8207,   119,  8134,   114,  5632,  5381,     0,     0,     0],
        [12199,   119,  8134,   114,  5632,  5381,  5317,     0,     0,     0],
        [  163,   119,  8134,   114,  5632,  5381,  5317,  3119,     0,     0],
        [  119,  8134,   114,  5632,  5381,  5317,  3119,  7415,     0,     0],
        [ 8134,   114,  5632,  5381,  5317,  3119,  7415,  3146,     0,     0],
        [  157,  8175,   114,  5632,  5381,  5317,  3119,  7415,  3146,  4415],
        [  155,   114,  5632,  5381,  5317,  3119,  7415,  3146,  4415,  1169],
        [  114,  5632,  5381,  5317,  3119,  7415,  3146,  4415,  1169,   868],
        [ 5632,  5381,  5317,  3119,  7415,  3146,  4415,  1169,   868,   117],
        [ 5381,  5317,  3119,  7415,  3146,  4415,  1169,   868,   117,   788],
        [ 5317,  3119,  7415,  3146,  4415,  1169,   868,   117,   788,   897],
        [ 3119,  7415,  3146,  4415,  1169,   868,   117,   788,   897,   769],
        [ 7415,  3146,  4415,  1169,   868,   117,   788,   897,   769,  3837],
        [ 3146,  4415,  1169,   868,   117,   788,   897,   769,  3837,  2110],
        [ 4415,  1169,   868,   117,   788,   897,   769,  3837,  2110,   739],
        [ 1169,   868,   117,   788,   897,   769,  3837,  2110,   739,   886],
        [  868,   117,   788,   897,   769,  3837,  2110,   739,   886,  4500],
        [  117,   788,   897,   769,  3837,  2110,   739,   886,  4500,   117],
        [  788,   897,   769,  3837,  2110,   739,   886,  4500,   117,  4276],
        [  897,   769,  3837,  2110,   739,   886,  4500,   117,  4276,  3326],
        [  769,  3837,  2110,   739,   886,  4500,   117,  4276,  3326,  2495],
        [ 3837,  2110,   739,   886,  4500,   117,  4276,  3326,  2495,  1333],
        [ 2110,   739,   886,  4500,   117,  4276,  3326,  2495,  1333,   868],
        [  739,   886,  4500,   117,  4276,  3326,  2495,  1333,   868,  5442],
        [  886,  4500,   117,  4276,  3326,  2495,  1333,   868,  5442,  1469],
        [ 4500,   117,  4276,  3326,  2495,  1333,   868,  5442,  1469,  1139],
        [  117,  4276,  3326,  2495,  1333,   868,  5442,  1469,  1139,  4276],
        [ 4276,  3326,  2495,  1333,   868,  5442,  1469,  1139,  4276,  4852],
        [ 3326,  2495,  1333,   868,  5442,  1469,  1139,  4276,  4852,  2792],
        [ 2495,  1333,   868,  5442,  1469,  1139,  4276,  4852,  2792,  3300],
        [ 1333,   868,  5442,  1469,  1139,  4276,  4852,  2792,  3300,   117],
        [  868,  5442,  1469,  1139,  4276,  4852,  2792,  3300,   117,  1963],
        [ 5442,  1469,  1139,  4276,  4852,  2792,  3300,   117,  1963,  3362],
        [ 1469,  1139,  4276,  4852,  2792,  3300,   117,  1963,  3362,  1599],
        [ 1139,  4276,  4852,  2792,  3300,   117,  1963,  3362,  1599,  3614],
        [ 4276,  4852,  2792,  3300,   117,  1963,  3362,  1599,  3614,   117],
        [ 4852,  2792,  3300,   117,  1963,  3362,  1599,  3614,   117,  6435],
        [ 2792,  3300,   117,  1963,  3362,  1599,  3614,   117,  6435,  3118],
        [ 3300,   117,  1963,  3362,  1599,  3614,   117,  6435,  3118,  2898],
        [  117,  1963,  3362,  1599,  3614,   117,  6435,  3118,  2898,  3633],
        [ 1963,  3362,  1599,  3614,   117,  6435,  3118,  2898,  3633,  4276],
        [ 3362,  1599,  3614,   117,  6435,  3118,  2898,  3633,  4276,   119],
        [ 1599,  3614,   117,  6435,  3118,  2898,  3633,  4276,   119,     0],
        [ 3614,   117,  6435,  3118,  2898,  3633,  4276,   119,     0,     0],
        [  117,  6435,  3118,  2898,  3633,  4276,   119,     0,     0,     0],
        [ 6435,  3118,  2898,  3633,  4276,   119,   517,     0,     0,     0]])]
"""
